# QR Code Test Project

Проект для тестирования и демонстрации функциональности генерации и размещения QR-кодов на изображениях. Включает Python-приложение для обработки изображений, n8n-воркфлоу для автоматизации процессов и Telegram-бота для взаимодействия с пользователями.

![alt text](<_qrcode_test_bot – (1116492) 2025-12-24 15-12-21 (online-video-cutter.com) (1).gif>)

## Структура проекта


### Папка `src/qr_code_test/` - Основной код приложения
- `main.py` - Главный файл приложения, точка входа
- `ngrok.py` - Модуль для работы с ngrok (туннелирование для локального сервера)
- `qr_generator.py` - Генерация QR-кодов
- `schemas.py` - Схемы данных (Pydantic модели)
- `services.py` - Бизнес-логика и сервисы
- `state.py` - Управление состоянием приложения

### Папка `n8n_workflows/` - n8n воркфлоу
#### Задание 1: Обработка данных транзакций
- `task_1.json` - Воркфлоу для обработки тестовых данных транзакций (оригинальный + оптимизированный)
- `WORKFLOW_DESCRIPTION.md` - Подробное описание task_1.json

#### Задание 2: AI-размещение QR-кодов
- `Qr Test.json` - Воркфлоу Telegram-бота для размещения QR-кодов на изображениях
- `QR_WORKFLOW_DESCRIPTION.md` - Подробное описание Qr Test.json

### Папка `tests/` - Тесты
- `test_qr.py` - Модульные тесты для функциональности QR-кодов

### Папка `data/` - Данные и ресурсы
Папка для хранения тестовых данных, изображений и других ресурсов проекта.

## Задания и воркфлоу

### Задание 1: Обработка данных транзакций (`task_1.json`)
**Цель:** Оптимизация воркфлоу для обработки больших объемов данных о транзакциях клиентов.

- **Оригинальный поток:** Детальная валидация на 8 записях с множественными IF-узлами
- **Оптимизированный поток:** Массовую обработку 400 записей с улучшенной архитектурой
- **Функциональность:** Генерация тестовых данных, валидация email/сумм/валют, экспорт в Excel, HTTP-запросы

### Задание 2: AI-размещение QR-кодов (`Qr Test.json`)
**Цель:** Создание Telegram-бота для автоматического размещения QR-кодов на изображениях с помощью AI.

- **Функциональность:**
  - Получение изображений из Telegram
  - AI-анализ (Claude) для выбора безопасной позиции QR-кода
  - Наложение QR-кода через локальный API
  - Отправка результата обратно в чат
- **Особенности:** Избегание перекрытия важных объектов (лица, текст, логотипы)

## Установка и запуск

### Требования
- Python 3.8+
- n8n (для запуска воркфлоу)
- ngrok (для туннелирования)

## Использование

1. **Запустите n8n** и импортируйте воркфлоу из папки `n8n_workflows/`
2. **Настройте ngrok** для доступа к локальному серверу
3. **Запустите Python-приложение** для обработки изображений
4. **Отправьте фото в Telegram-бот** для тестирования размещения QR-кода

## Архитектура

Проект использует микросервисную архитектуру:
- **Python FastAPI** для обработки изображений и генерации QR
- **n8n** для оркестрации бизнес-процессов
- **Telegram Bot API** для пользовательского интерфейса
- **AI-модели** (Claude, Gemini) для анализа изображений

